# Курсовая работа по нейронным сетям

## Тема: Обнаружение аномалий при помощи варационного автокодировщика.

1. Реализуйте архитектуру вариационного автокодировщика на основе сверточных сетей в соответствии с публикацией "Auto-Encoding Variational Bayes" [arXiv:1312.6114].

2. Обучите модель только на изображениях одного класса из набора данных Fashion MNIST.

3. Используйте два подхода для обнаружения аномалий:

    - По величине плотности вероятности в латентном пространстве

    - По ошибке восстановления изображения

4. Протестируйте способность модели отличать класс, использованный при обучении, от других классов. Количественно оцените результаты и сделайте выводы.

## Доработки после предзащиты

- Модель есть, договорились поменять ошибку восстановления на MSE на нормированных данных, взять loss = MSE+alpha * KLD, путем экспериментов подобрать alpha так, чтобы в минимуме по порядку величины на валидации было MSE ~ alpha * KLD;  

- Разобраться с AUC по ошибке восстановления, почему хуже случайного, исправить; 

- Сделать детектор аномалий через log likelihood в 2D PCA пространстве латентного пространства (вариант: посмотреть на распределение val log likelihood для нормальных объектов, считать p-value для неизвестных объектов по этому распределению, на пороге значимости 0.05 считать объект аномальным); 

- Подобрать пороги для обоих детекторов аномалий (для log likelihood можно взять p-value <= 0.05), посчитать ROC AUC для обоих детекторов аномалий, всё визуализировать

## Запуск проекта

### Установка зависимостей

Разверните виртуальное окружение:
```bash
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

Установите необходимые библиотеки:

```bash
pip install -r requirements.txt
```

### Запуск

Запустите основной скрипт для обучения модели и оценки:

```
python vae_experiment/main.py
```
